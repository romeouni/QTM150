"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg = mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3)
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg = mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable"))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg = mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3)
relig_summary <- gss_cat %>%
group_by(relig) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
arrange(desc(avg))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=avg, y=fct_rev(fct_reorder(income3,avg))))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=avg, y=fct_rev(fct_reorder(income3,avg)))) +
geom_col()
relig_summary <- gss_cat %>%
group_by(relig) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
arrange(desc(avg))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=avg, y=fct_reorder(income3,avg))) +
geom_col()
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=tvhours, y=fct_reorder(income3,avg))) +
geom_col()
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T))
gss_cat %>%
mutate(income3 = fct_recode(rincome,
"Less than $8k" = "Lt $1000",
"Less than $8k" = "$1000 to 2999",
"Less than $8k" = "$3000 to 3999",
"Less than $8k" = "$4000 to 4999",
"Less than $8k" = "$5000 to 5999",
"Less than $8k" = "$6000 to 6999",
"Less than $8k" = "$7000 to 7999",
"Greater than $8K and Less than $15K" = "$8000 to 9999",
"Greater than $8K and Less than $15K" = "$10000 - 14999",
"$15K or more" = "$15000 - 19999",
"$15K or more" = "$20000 - 24999",
"$15K or more" = "$25000 or more",
"Other" = "Refused",
"Other" = "Don't know",
"Other" = "No answer",
"Other" = "Not applicable")) %>%
group_by(income3) %>%
summarize(avg=mean(tvhours, na.rm=T)) %>%
ggplot(aes(x=avg, y=fct_reorder(income3,avg))) +
geom_col()
library(nycflights13)
flights_dt <- flights %>%
filter(!is.na(dep_time), !is.na(arr_time)) %>%  # remove all cancelled fights
mutate(
dep_time = make_datetime_100(year, month, day, dep_time),
arr_time = make_datetime_100(year, month, day, arr_time),
sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
) %>%
select(origin, dest, ends_with("delay"), ends_with("time"))
library(lubridate)
flights_dt <- flights %>%
filter(!is.na(dep_time), !is.na(arr_time)) %>%  # remove all cancelled fights
mutate(
dep_time = make_datetime_100(year, month, day, dep_time),
arr_time = make_datetime_100(year, month, day, arr_time),
sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
) %>%
select(origin, dest, ends_with("delay"), ends_with("time"))
flights_dt <- flights %>%
filter(!is.na(dep_time), !is.na(arr_time)) %>%  # remove all cancelled fights
mutate(
dep_time = make_datetime_100(year, month, day, dep_time),
arr_time = make_datetime_100(year, month, day, arr_time),
sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
) %>%
select(origin, dest, ends_with("delay"), ends_with("time"))
make_datetime(year, month, day, time %/% 100, time %% 100)
make_datetime_100 <- function(year, month, day, time) {
make_datetime(year, month, day, time %/% 100, time %% 100)
}
make_datetime_100 <- function(year, month, day, time) {
make_datetime(year, month, day, time %/% 100, time %% 100)
}
flights_dt <- flights %>%
filter(!is.na(dep_time), !is.na(arr_time)) %>%  # remove all cancelled fights
mutate(
dep_time = make_datetime_100(year, month, day, dep_time),
arr_time = make_datetime_100(year, month, day, arr_time),
sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
) %>%
select(origin, dest, ends_with("delay"), ends_with("time"))
flights_dt %>%
mutate(day = wday(dep_time, label=T)) %>%
ggplot(aes(day)) +
geom_bar()
str(flights_dt)
flights_dt %>%
mutate(minute = minute(sched_dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
flights_dt %>%
mutate(minute = minute(dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
flights_dt %>%
mutate(minute = minute(sched_dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
str(flights)
flights %>%
mutate(weekday = wday(make_date(year, month, day), label=T)) %>%
ggplot(aes(day)) +
geom_bar()
flights %>%
mutate(weekday = wday(make_date(year, month, day), label=T)) %>%
ggplot(aes(weekday)) +
geom_bar()
flights %>%
mutate(minute = minute(sched_dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
str(flights)
flights %>%
mutate(minute = dep_time%%100) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
flights %>%
mutate(minute = sched_dep_time%%100) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
mutate(minute = minute(hms(dep_time)) %>%
flights %>%
mutate(minute = minute(hms(dep_time))) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
flights %>%
make_datetime_100 <- function(year, month, day, time) {
make_datetime(year, month, day, time %/% 100, time %% 100)
}
flights_dt <- flights %>%
filter(!is.na(dep_time), !is.na(arr_time)) %>%  # remove all cancelled fights
mutate(
dep_time = make_datetime_100(year, month, day, dep_time),
arr_time = make_datetime_100(year, month, day, arr_time),
sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
) %>%
select(origin, dest, ends_with("delay"), ends_with("time"))
flights %>%
mutate(minute = minute(dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
str(flights_dt)
flights_dt <- flights %>%
filter(!is.na(dep_time), !is.na(arr_time)) %>%  # remove all cancelled fights
mutate(
dep_time = make_datetime_100(year, month, day, dep_time),
arr_time = make_datetime_100(year, month, day, arr_time),
sched_dep_time = make_datetime_100(year, month, day, sched_dep_time),
sched_arr_time = make_datetime_100(year, month, day, sched_arr_time)
) %>%
select(origin, dest, ends_with("delay"), ends_with("time"))
flights %>%
mutate(minute = minute(dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
flights_dt %>%
mutate(minute = minute(dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
flights_dt %>%
mutate(minute = minute(sched_dep_time)) %>%
group_by(minute) %>%
summarize(avg_dep_delay_m = mean(dep_delay)) %>%
ggplot(aes(x=minute, y=avg_dep_delay_m)) +
geom_line()
knitr::opts_chunk$set(echo = TRUE)
library(tidyverse)
library(nycflights13)
band <- tribble(
~name, ~band,
"Mick", "Stones",
"John", "Beatles",
"Paul", "Beatles"
)
band
instrument <- tribble(
~name, ~plays,
"John", "guitar",
"Paul", "bass",
"Keith", "guitar"
)
semi_join(band, instrument, by="name")
band %>%
left_join(instrument) %>%
filter(!is.na(plays)) %>%
select(name, band)
flights %>%
group_by(dest) %>%
summarize(num_flights = n())
flights %>%
count(dest) %>%
top_n(10) %>%
arrange(desc(n))
flights %>%
semi_join(top_dest, by="dest") %>%
count(carrier)
top_dest <- flights %>%
count(dest, sort = T) %>%
top_n(10)
flights %>%
semi_join(top_dest, by="dest") %>%
count(carrier)
flights %>%
semi_join(top_dest, by="dest") %>%
count(carrier)
